<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gr√°fico de Evolu√ß√£o dos batizando</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
<style>
    body { font-family: Arial, sans-serif; }
    h1 { text-align: center; margin-bottom: 10px; }
    .button-container { text-align: center; margin-bottom: 20px; flex-wrap: wrap; }
    button {
        margin: 5px;
        padding: 10px 20px;
        background-color: #4CAF50;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
    }
    button:hover { background-color: #45a049; }
    .chart-container { max-width: 900px; margin: auto; }
    #resumo {
        max-width: 900px;
        margin: 20px auto;
        text-align: center;
        background: #f3f3f3;
        padding: 10px;
        border-radius: 10px;
        font-size: 15px;
    }
</style>
</head>
<body>
<!-- üí† SPLASH SCREEN -->
<div id="splash-screen">
  <img src="fundo.png" alt="Logo" class="splash-logo">
</div>

<style>
  #splash-screen {
    position: fixed;
    inset: 0;
    background: radial-gradient(circle at center, #111 0%, #000 100%);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    animation: fadeOut 1s ease 4s forwards;
  }

  .splash-logo {
    width: 200px;
    filter: drop-shadow(0 0 20px #00c3ff);
    opacity: 0;
    transform: scale(0.85);
    animation: glowIn 1.5s ease forwards;
  }

  @keyframes glowIn {
    0% {
      opacity: 0;
      transform: scale(0.85);
      filter: drop-shadow(0 0 0px #00c3ff);
    }
    100% {
      opacity: 1;
      transform: scale(1);
      filter: drop-shadow(0 0 25px #00c3ff);
    }
  }

  @keyframes fadeOut {
    to {
      opacity: 0;
      visibility: hidden;
    }
  }
</style>

<script>
  window.addEventListener('load', () => {
    setTimeout(() => {
      document.getElementById('splash-screen').style.display = 'none';
    }, 5000);
  });
</script>

<div id="orientacaoMensagem" style="display:none;text-align:center;font-size:18px;color:red;padding:10px;background-color:yellow;">
    Por favor, altere a orienta√ß√£o da tela para paisagem.
</div>

<h1>Gr√°fico de Evolu√ß√£o dos Valores Mensais</h1>

<div class="button-container">
    <!-- Bot√µes gerados para cada congrega√ß√£o -->
    <button onclick="mostrarGrafico('SEABRA')">SEABRA</button>
    <button onclick="mostrarGrafico('ITAPUA I')">ITAPUA I</button>
    <button onclick="mostrarGrafico('SAO GABRIEL')">SAO GABRIEL</button>
    <button onclick="mostrarGrafico('MUTIRAO')">MUTIRAO</button>
    <button onclick="mostrarGrafico('QUADRA 10 NORTE')">QUADRA 10 NORTE</button>
    <button onclick="mostrarGrafico('LUIZA DE BRITO')">LUIZA DE BRITO</button>
    <button onclick="mostrarGrafico('PAQUETA')">PAQUETA</button>
    <button onclick="mostrarGrafico('PALMEIRAS')">PALMEIRAS</button>
    <button onclick="mostrarGrafico('RESIDENCIAL CAIC')">RESIDENCIAL CAIC</button>
    <button onclick="mostrarGrafico('CORREGO RICO')">CORREGO RICO</button>
    <button onclick="mostrarGrafico('IMIGRANTES')">IMIGRANTES</button>
    <button onclick="mostrarGrafico('QUADRA 09 NORTE')">QUADRA 09 NORTE</button>
    <button onclick="mostrarGrafico('QUADRA 04 SUL')">QUADRA 04 SUL</button>
    <button onclick="mostrarGrafico('LAGOA FORMOSA')">LAGOA FORMOSA</button>
    <button onclick="mostrarGrafico('SEDE')">SEDE</button>
    <button onclick="mostrarGrafico('QUADRA 15 NORTE')">QUADRA 15 NORTE</button>
    <button onclick="mostrarGrafico('QUADRA 19 NORTE')">QUADRA 19 NORTE</button>
    <button onclick="mostrarGrafico('BARROLANDIA')">BARROLANDIA</button>
    <button onclick="mostrarGrafico('QUADRA 06 NORTE')">QUADRA 06 NORTE</button>
    <button onclick="mostrarGrafico('SANTO ANTONIO DAS BRANCAS')">SANTO ANTONIO DAS BRANCAS</button>
    <button onclick="mostrarGrafico('QUADRA 04 LESTE')">QUADRA 04 LESTE</button>
    <button onclick="mostrarGrafico('SANTA CRUZ DE MUCUGE BAHIA')">SANTA CRUZ DE MUCUGE BAHIA</button>
</div>

<div id="resumo">Selecione uma congrega√ß√£o acima para ver o resumo.</div>

<div class="chart-container">
    <canvas id="grafico" width="400" height="200"></canvas>
</div>

<!-- üîΩ Bot√£o aparece somente ap√≥s escolher uma congrega√ß√£o -->
<div id="toggleContainer" style="display:none; text-align:center; margin-top:15px;">
    <button id="toggleValores" onclick="alternarValores()" 
        style="background-color:#007BFF; color:white; padding:10px 20px; 
               border:none; border-radius:8px; cursor:pointer; font-size:16px;">
        Mostrar valores
    </button>
</div>

<script>
// ==== DETEC√á√ÉO DE DISPOSITIVO E ORIENTA√á√ÉO ====
function isMobileDevice() {
    const ua = navigator.userAgent || navigator.vendor || window.opera;
    return /Mobi|Android|iPhone|iPad|iPod/i.test(ua);
}
function forcarPaisagem() {
    const mensagem = document.getElementById('orientacaoMensagem');
    const isPortrait = window.innerWidth < window.innerHeight;
    mensagem.style.display = (isMobileDevice() && isPortrait) ? 'block' : 'none';
}
window.addEventListener('resize', forcarPaisagem);
window.addEventListener('orientationchange', forcarPaisagem);
forcarPaisagem();

// ==== DADOS (CONVERTIDOS DA PLANILHA) ====
// Arrays com 12 meses (jan..dez). Meses sem dados = 0.
const dados = {
  "SEABRA": {
    2024: [0,0,2,0,0,0,0,0,0,0,0,0],
    2025: [0,0,0,0,0,0,0,5,0,0,0,0]
  },
  "ITAPUA I": {
    2024: [0,0,1,0,0,0,0,0,1,0,0,0],
    2025: [0,0,0,0,0,6,0,1,0,0,0,0]
  },
  "SAO GABRIEL": {
    2024: [0,0,1,0,0,3,0,0,0,0,0,0],
    2025: [0,0,0,0,0,0,0,0,0,0,0,0]
  },
  "MUTIRAO": {
    2024: [0,0,1,0,0,0,0,0,0,0,0,0],
    2025: [0,0,0,0,0,1,0,0,0,0,2,0]
  },
  "QUADRA 10 NORTE": {
    2024: [0,0,1,0,0,1,0,0,0,0,0,5],
    2025: [0,0,3,0,0,0,0,0,0,0,0,0]
  },
  "LUIZA DE BRITO": {
    2024: [0,0,6,0,0,0,0,0,0,0,0,0],
    2025: [0,0,0,0,0,0,0,0,0,0,0,0]
  },
  "PAQUETA": {
    2024: [0,0,0,0,0,1,0,0,0,0,0,0],
    2025: [0,0,0,0,0,0,0,0,0,0,0,0]
  },
  "PALMEIRAS": {
    2024: [0,0,0,0,0,1,0,0,0,0,0,0],
    2025: [0,0,0,0,0,0,0,0,0,0,3,0]
  },
  "RESIDENCIAL CAIC": {
    2024: [0,0,0,0,0,1,0,0,0,0,0,1],
    2025: [0,0,1,0,0,0,0,0,0,0,0,0]
  },
  "CORREGO RICO": {
    2024: [0,0,0,0,0,2,0,0,0,0,0,1],
    2025: [0,0,0,0,0,0,0,0,0,0,0,0]
  },
  "IMIGRANTES": {
    2024: [0,0,0,0,0,3,0,0,0,0,0,0],
    2025: [0,0,0,0,0,1,0,0,0,0,0,0]
  },
  "QUADRA 09 NORTE": {
    2024: [0,0,0,0,0,4,0,0,0,0,0,2],
    2025: [0,0,0,0,0,2,0,0,0,0,0,0]
  },
  "QUADRA 04 SUL": {
    2024: [0,0,0,0,0,3,0,0,0,0,0,1],
    2025: [0,0,0,0,0,0,0,0,0,0,0,0]
  },
  "LAGOA FORMOSA": {
    2024: [0,0,0,0,0,0,0,0,3,0,0,0],
    2025: [0,0,0,0,0,0,0,0,0,0,0,0]
  },
  "SEDE": {
    2024: [0,0,0,0,0,0,0,0,0,1,0,2],
    2025: [0,0,3,0,0,2,0,0,0,0,1,0]
  },
  "QUADRA 15 NORTE": {
    2024: [0,0,0,0,0,0,0,0,0,0,0,1],
    2025: [0,0,0,0,0,2,0,0,0,0,0,0]
  },
  "QUADRA 19 NORTE": {
    2024: [0,0,0,0,0,0,0,0,0,0,0,1],
    2025: [0,0,0,0,0,0,0,0,0,0,0,0]
  },
  "BARROLANDIA": {
    2024: [0,0,0,0,0,0,0,0,0,0,0,1],
    2025: [0,0,0,0,0,0,0,0,0,0,0,1]
  },
  "QUADRA 06 NORTE": {
    2024: [0,0,0,0,0,0,0,0,0,0,0,1],
    2025: [0,0,0,0,0,0,0,0,0,0,0,1]
  },
  "SANTO ANTONIO DAS BRANCAS": {
    2024: [0,0,0,0,0,0,0,0,0,0,0,0],
    2025: [0,0,0,1,0,0,0,0,0,0,0,0]
  },
  "QUADRA 04 LESTE": {
    2024: [0,0,0,0,0,0,0,0,0,0,0,0],
    2025: [0,0,0,0,0,0,0,2,0,0,0,0]
  },
  "SANTA CRUZ DE MUCUGE BAHIA": {
    2024: [0,0,0,0,0,0,0,0,0,0,0,0],
    2025: [0,0,0,0,0,0,0,0,3,0,0,0]
  }
};

// ==== VARI√ÅVEIS GLOBAIS ====
let chart;
let mostrarValores = false;

// ==== FUN√á√ïES ====
function normalizarTexto(texto) {
    return texto.normalize('NFD').replace(/[\u0300-\u036f]/g, "").toLowerCase();
}

function mostrarGrafico(area) {
    const meses = ["Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];
    const chave = Object.keys(dados).find(k => normalizarTexto(k) === normalizarTexto(area));
    if (!chave) return alert(`Congrega√ß√£o "${area}" n√£o encontrada.`);

    const valores2024 = dados[chave][2024] || Array(12).fill(0);
    const valores2025 = dados[chave][2025] || Array(12).fill(0);

    const total2024 = valores2024.reduce((a,b)=>a+b,0);
    const total2025 = valores2025.reduce((a,b)=>a+b,0);
    const variacao = total2024 > 0 ? ((total2025 - total2024) / total2024 * 100).toFixed(2) : 0;

    const melhorMes = meses[valores2025.indexOf(Math.max(...valores2025))] || "-";
    const melhores = valores2025.filter(v=>v>0);
    const piorMes = melhores.length ? meses[valores2025.indexOf(Math.min(...melhores))] : "-";

    document.getElementById("resumo").innerHTML = `
        <b>${chave}</b><br>
        Total 2024: ${total2024} |
        Total 2025: ${total2025}<br>
        <b>Varia√ß√£o:</b> ${variacao}%<br>
        Melhor m√™s 2025: <b>${melhorMes}</b> | Pior m√™s: <b>${piorMes}</b>
    `;

    if (chart) chart.destroy();

    chart = new Chart(document.getElementById('grafico').getContext('2d'), {
        type: 'line',
        data: {
            labels: meses,
            datasets: [
                {
                    label: 'Ano 2024',
                    data: valores2024,
                    borderColor: '#36A2EB',
                    backgroundColor: 'rgba(54,162,235,0.2)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.3,
                    pointRadius: 5
                },
                {
                    label: 'Ano 2025',
                    data: valores2025,
                    borderColor: '#FF6384',
                    backgroundColor: 'rgba(255,99,132,0.2)',
                    borderWidth: 2,
                    fill: true,
                    tension: 0.3,
                    pointRadius: 5
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { position: 'top' },
                datalabels: {
                    display: mostrarValores,
                    align: 'top',
                    color: '#000',
                    font: { weight: 'bold', size: 12 },
                    formatter: value => value > 0 ? value : ''
                },
                title: { display: true, text: `Comparativo de Batizandos - ${chave}` }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    title: { display: true, text: "Quantidade" }
                }
            }
        },
        plugins: [ChartDataLabels]
    });

    // Exibe bot√£o de altern√¢ncia ap√≥s exibir gr√°fico
    document.getElementById("toggleContainer").style.display = "block";
    document.getElementById("toggleValores").textContent = "Mostrar valores";
    mostrarValores = false;
}

function alternarValores() {
    mostrarValores = !mostrarValores;
    const botao = document.getElementById("toggleValores");
    botao.textContent = mostrarValores ? "Ocultar valores" : "Mostrar valores";
    if (chart) {
        chart.options.plugins.datalabels.display = mostrarValores;
        chart.update();
    }
}
</script>
</body>
</html>

